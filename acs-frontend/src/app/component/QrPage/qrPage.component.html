<div class="container">
  <div class="panel left">
    <div class="card">
      <h2>ç”¢ç”Ÿé–€ç¦ QRCode</h2>
      <form (ngSubmit)="generateQrCode()" class="form">
        <input
          type="text"
          [(ngModel)]="userId"
          name="userId"
          placeholder="è«‹è¼¸å…¥å“¡ç·¨"
          required
        />
        <button type="submit">ç”¢ç”Ÿ QR Code</button>
      </form>

      <div class="qrcode-preview" *ngIf="qrCode || isQrExpired">
        <img
          [src]="qrCode"
          alt="QRCode"
          [style.filter]="isQrExpired ? 'grayscale(1) blur(1px)' : 'none'"
          [style.opacity]="isQrExpired ? 0.5 : 1"
        />

        <p class="caption" *ngIf="!isQrExpired">â³ è«‹æ–¼ {{ countdown }} ç§’å…§æƒæ</p>
        <p class="caption expired" *ngIf="isQrExpired">âš ï¸ QR Code å·²éæœŸï¼Œè«‹é‡æ–°ç”¢ç”Ÿ</p>
      </div>

    </div>
  </div>

  <div class="panel right">
    <div class="card">
      <h2>é–‹é–€ç´€éŒ„</h2>

      <div *ngIf="isRequesting && !connectionError" class="status loading">
        ğŸš€ è³‡æ–™è®€å–ä¸­...
      </div>

      <div *ngIf="connectionError" class="status error">
        âŒ WebSocket é€£ç·šå¤±æ•—ï¼Œè«‹ç¢ºèªå¾Œç«¯æœå‹™æ˜¯å¦å•Ÿå‹•
      </div>

      <ul *ngIf="!connectionError && accessRecords.length === 0" class="status empty">
        <li>å°šç„¡é–‹é–€ç´€éŒ„</li>
      </ul>

      <ul *ngIf="!connectionError && accessRecords.length > 0" class="record-list">
        <li *ngFor="let record of accessRecords" [class.success]="record.successful" [class.fail]="!record.successful">
          <div class="left-info">
            <div class="time">{{ record.accessTime | date:'yyyy-MM-dd HH:mm:ss' }}</div>
            <div class="userId">å“¡ç·¨ï¼š{{ record.userId }}</div>
            <div class="cardId">å¡è™Ÿï¼š{{ record.cardId }}</div>
            <div class="device">è¨­å‚™ï¼š{{ record.deviceId }}</div>
          </div>
          <div class="right-status">
            <div class="successful">
              {{ record.successful ? 'âœ… æˆåŠŸ' : 'âŒ æ‹’çµ•' }}
            </div>
            <div class="reason" *ngIf="record.reason">åŸå› ï¼š{{ record.reason }}</div>
          </div>
        </li>
      </ul>
      
    </div>
  </div>
</div>
